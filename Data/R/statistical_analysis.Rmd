---
title: "Protobuf in REST Applications Analysis"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

# Tests

There were three types of tests:

-   Baseline -\> to verify how would the application work with minimal load
-   Load -\> to verify how would the application react to a decent load
-   Stress -\> to verify how would the application react to a stress load

Both versions of the application underwent the same tests. Each type of test did the same request, the only change was the load on each one. Chaging the amount of Threads sending requests and the ammount of time the tests underwent.

Four different endpoints were used for the tests with various purposes, for a better assessment between the results:  

 * GET Plan - received by the first instance of the Plans microservice, it retrieves all plans, meaning it needs to ask the second instance for their database information. This is perfect to analyze the difference between the bytes received.\
 * GET Specific Plan - sent to the second Subscription microservice, it ask for the plan information that the user has associated to its subscription. Because the jwt token was from a user from the first microservice, the second one has to ask the first one for the information. The plan in question is saved on the database of the second instance, so the first one will need to retrieve that information. Because the request passes though various stages before returning something, it helps simulate a sitution where four instances are working for a single request.\
 * POST Subscriber - received by the first User microservice, it needs to ask the second one if the user already exits and after that send the creation request for the Subscription microservice, that proceeds to ask the Plan microservice if the plan associated with the creation request is valid.\
 * POST Plan - requests the Plan microservice to create a valid plan. For the request be accepted, the plan can not exist in neither of the instances.

# Analysis

Analyzing all of the data obtained, it is possible to verified that between the two versions of the application there is a significant difference. This affirmation can be proved by the hypotheses tests done.

Knowing that there is a significant difference between them, there is still the question of what does that difference tell.

Well, in the table, we can see that for the baseline tests Protobuf and JSON are eye to eye in elapsed time. Well in some endpoints JSON as a sightly inferior average elapsed time, being it a plus. For the bytes, when a request is done to "GET Plan", endpoint that retrieves every plan, a vast amount of information is returned, making it easier to see that Protobuf uses least amount of memory. For the throughput, even if it is a very small difference, Protobuf has the lead. Analyzing the data from the load tests, it is evident that Protobuf exceeds. With smaller elapsed times, least amount of bytes received, higher throughput, smaller error rate and more samples obtained. Adding the stress tests results to the mixer, one can perceived what the load tests pre-accessed. Protobuf has the lead in every field and JSON starts showing big weakness. Protobuf can handle more extreme situations, with error rates, compared to JSON, low and reasonable throughput.

| **Endpoint**          | **Format**   | **Test**   | **Mean Elapsed Time (ms)** | **Mean Bytes** | **Thoughput** | **Samples** | **Error (%)** | **Success Samples** |
|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| **GET Plan**          | **Protobuf** | *Baseline* | 57.48                      | 155001.32      | 29.8          | 5368        | 0             | 5368                |
|                       |              | *Load*     | 778.82                     | 481577.09      | 20.6          | 7458        | 0             | 7458                |
|                       |              | *Stress*   | 4877.28                    | 801593.87      | 15.3          | 9242        | 0             | 9242                |
|                       |              |            |                            |                |               |             |               |                     |
|                       | **JSON**     | *Baseline* | 64.60                      | 502139.83      | 29.6          | 5324        | 0             | 5324                |
|                       |              | *Load*     | 870.53                     | 1538487.83     | 18.9          | 6858        | 0             | 6858                |
|                       |              | *Stress*   | 21092.84                   | 1340689.67     | 10.3          | 6385        | 42.65         | 3661                |
|                       |              |            |                            |                |               |             |               |                     |
| **GET Specific Plan** | **Protobuf** | *Baseline* | 31.56                      | 471.73         | 29.9          | 5366        | 0             | 5366                |
|                       |              | *Load*     | 2722.95                    | 472.52         | 20.6          | 7443        | 0.23          | 7425                |
|                       |              | *Stress*   | 140301.59                  | 502.91         | 14.2          | 9229        | 13.56         | 7977                |
|                       |              |            |                            |                |               |             |               |                     |
|                       | **JSON**     | *Baseline* | 30.46                      | 603.73         | 29.6          | 5322        | 0             | 5322                |
|                       |              | *Load*     | 3562.23                    | 604.32         | 19            | 6842        | 0.34          | 6818                |
|                       |              | *Stress*   | 127894.27                  | 1143.33        | 9.7           | 6137        | 79.91         | 1232                |
|                       |              |            |                            |                |               |             |               |                     |
| **POST Subscriber**   | **Protobuf** | *Baseline* | 228.49                     | 682.32         | 30            | 5366        | 0             | 5366                |
|                       |              | *Load*     | 24547.52                   | 679.23         | 20            | 7433        | 0.11          | 7424                |
|                       |              | *Stress*   | 51012.44                   | 681.30         | 11.5          | 7572        | 7.70          | 6988                |
|                       |              |            |                            |                |               |             |               |                     |
|                       | **JSON**     | *Baseline* | 225.98                     | 665.31         | 29.7          | 5320        | 0             | 5320                |
|                       |              | *Load*     | 26056.61                   | 662.29         | 18.4          | 6825        | 0.21          | 6810                |
|                       |              | *Stress*   | 62193.64                   | 1181.59        | 7.9           | 4986        | 86.10         | 693                 |
|                       |              |            |                            |                |               |             |               |                     |
| **POST Plan**         | **Protobuf** | *Baseline* | 13.23                      | 682.32         | 30            | 5368        | 0             | 5368                |
|                       |              | *Load*     | 372.53                     | 679.23         | 19.1          | 6866        | 0             | 6866                |
|                       |              | *Stress*   | 1825.16                    | 681.30         | 10.4          | 6243        | 0             | 6243                |
|                       |              |            |                            |                |               |             |               |                     |
|                       | **JSON**     | *Baseline* | 12.75                      | 698.04         | 29.7          | 5315        | 0             | 5315                |
|                       |              | *Load*     | 417.40                     | 690.65         | 17.4          | 6261        | 0             | 6261                |
|                       |              | *Stress*   | 30905.40                   | 1129.19        | 7.2           | 4420        | 31.06         | 3047                |

# Baseline

**Conditions**

Test Setup

\|- Baseline Thread Group\
\|-\|-- GET All Plan\
\|-\|-- GET Plan from User\
\|-\|-- POST Create Subscriber\
\|-\|-- POST Create Plan

Thread Options

| Number of Threads | Ramp-up period (s) | Loop Count | Duration (s) |
|-------------------|--------------------|------------|--------------|
| 10                | 5                  | Infinite   | 180          |

```{r}
library(readr)

## Global Stats

stats <- read_csv("../Stats.csv")

## Load JSON files

jGP <- read_csv("../baseline/json_get_plan_data.csv")

jGSP <- read_csv("../baseline/json_get_specific_plan_data.csv")

jPCP <- read_csv("../baseline/json_post_plan_data.csv")

jPCS <- read_csv("../baseline/json_post_subs_data.csv")


## Load Protocol Buffers files

pGP <- read_csv("../baseline/protobuf_get_plan_data.csv")

pGSP <- read_csv("../baseline/protobuf_get_specific_plan_data.csv")

pPCP <- read_csv("../baseline/protobuf_post_plan_data.csv")

pPCS <- read_csv("../baseline/protobuf_post_subs_data.csv")



#### MEAN

## MEAN Elapsed

# JSON

mTimeJGP<-mean(jGP$elapsed)
mTimeJGSP<-mean(jGSP$elapsed)
mTimeJPCP<-mean(jPCP$elapsed)
mTimeJPCS<-mean(jPCS$elapsed)


# Protobuf

mTimePGP<-mean(pGP$elapsed)
mTimePGSP<-mean(pGSP$elapsed)
mTimePPCP<-mean(pPCP$elapsed)
mTimePPCS<-mean(pPCS$elapsed)

## MEAN Bytes

# JSON

mBytesJGP<-mean(jGP$bytes)
mBytesJGSP<-mean(jGSP$bytes)
mBytesJPCP<-mean(jPCP$bytes)
mBytesJPCS<-mean(jPCS$bytes)


# Protobuf

mBytesPGP<-mean(pGP$bytes)
mBytesPGSP<-mean(pGSP$bytes)
mBytesPPCP<-mean(pPCP$bytes)
mBytesPPCS<-mean(pPCS$bytes)

```

## Data

```{r}
library(knitr)

# Sample data
data <- data.frame(
  Endpoint = c("GET Plan","GET Specific Plan", "POST Subscriber", "POST Plan"),
  Mean_Elapsed_Time = c(round(mTimePGP,2),round(mTimePGSP,2),round(mTimePPCS,2),round(mTimePPCP,2)),
  Median_Elapsed_Time = round(c(median(pGP$elapsed),median(pGSP$elapsed),median(pPCS$elapsed),median(pPCP$elapsed)),2),
  #Elapsed_Time_Standart_Deviation = round(c(sd(pGP$elapsed),sd(pGSP$elapsed),sd(pPCS$elapsed),sd(pPCP$elapsed)),2),
  Mean_Bytes = c(round(mBytesPGP,2),round(mBytesPGSP,2),round(mBytesPPCS,2),round(mBytesPPCS,2)),
  Median_Bytes = round(c(median(pGP$bytes),median(pGSP$bytes),median(pPCS$bytes),median(pPCP$bytes)),2),
   #Bytes_Standart_Deviation = round(c(sd(pGP$bytes),sd(pGSP$bytes),sd(pPCS$bytes),sd(pPCP$bytes)),2),
  Throughput = c(stats$Throughput[1],stats$Throughput[2],stats$Throughput[3], stats$Throughput[4]),
  Error = c(stats$Error[1],stats$Error[2],stats$Error[3], stats$Error[4] ),
  Samples = c(nrow(pGP),nrow(pGSP),nrow(pPCS),nrow(pPCP))
)

data2 <- data.frame(
 Endpoint = c("GET Plan","GET Specific Plan", "POST Subscriber", "POST Plan"),
  Mean_Elapsed_Time = round(c(mTimeJGP,mTimeJGSP,mTimeJPCS,mTimeJPCP),2),
  Median_Elapsed_Time = round(c(median(jGP$elapsed),median(jGSP$elapsed),median(jPCS$elapsed),median(jPCP$elapsed)),2),
  #Elapsed_Time_Standart_Deviation = round(c(sd(jGP$elapsed),sd(jGSP$elapsed),sd(jPCS$elapsed),sd(jPCP$elapsed)),2),
  Mean_Bytes= round(c(mBytesJGP,mBytesJGSP,mBytesJPCS,mBytesJPCP),2),
  Median_Bytes = round(c(median(jGP$bytes),median(jGSP$bytes),median(jPCS$bytes),median(jPCP$bytes)),2),
  #Bytes_Standart_Deviation = round(c(sd(jGP$bytes),sd(jGSP$bytes),sd(jPCS$bytes),sd(jPCP$bytes)),2),
  Throughput = c(stats$Throughput[13],stats$Throughput[14],stats$Throughput[15],stats$Throughput[16]),
  Error = c(stats$Error[13],stats$Error[14],stats$Error[15],stats$Error[16]),
  Samples = c(nrow(jGP),nrow(jGSP),nrow(jPCS),nrow(jPCP))
)

# Display the table
kable(data, caption = "Performance Metrics for Protobuf Baseline Tests")
kable(data2, caption = "Performance Metrics for JSON Baseline Tests")
```

## Bar Plot

### Endpoint - GET Plan

#### Elapsed Time

```{r}
title <- "Baseline GET Plan Elapsed Time"
data <- round(c(mTimePGP, mTimeJGP),2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Elapsed Time (ms)")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)

```

#### Bytes

```{r}
title <- "Baseline GET Plan Bytes"
data <- round(c(mBytesPGP, mBytesJGP), 2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Bytes")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

#### Throughput

```{r}
title <- "Baseline GET Plan Throughput"
data <- c(stats$Throughput[1],stats$Throughput[13])
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Throughput /sec ")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

### Endpoint - GET Specific Plan

#### Elapsed Time

```{r}
title <- "Baseline GET Specific Plan Elapsed Time"
data <- round(c(mTimePGSP, mTimeJGSP),2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Elapsed Time (ms)")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

#### Bytes

```{r}
title <- "Baseline GET Specific Plan Bytes"
data <- round(c(mBytesPGSP, mBytesJGSP), 2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Bytes")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

#### Throughput

```{r}
title <- "Baseline GET Specific Plan Throughput"
data <- c(stats$Throughput[2],stats$Throughput[14])
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Throughput /sec ")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)


```

### Endpoint - POST Subscriber

#### Elapsed Time

```{r}
title <- "Baseline POST Subscriber Elapsed Time"
data <- round(c(mTimePPCS, mTimeJPCS),2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Elapsed Time (ms)")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)


```

#### Bytes

```{r}
title <- "Baseline POST Subscriber Bytes"
data <- round(c(mBytesPPCS, mBytesJPCS), 2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Bytes")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)

```

#### Throughput

```{r}
title <- "Baseline POST Subscriber Throughput"
data <- c(stats$Throughput[3],stats$Throughput[15])
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Throughput /sec ")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)

```

### Endpoint - POST Plan

#### Elapsed Time

```{r}
title <- "Baseline POST Plan Elapsed Time"
data <- round(c(mTimePPCP, mTimeJPCP), 2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format", "Elapsed Time (ms)")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title, ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)


```

#### Bytes

```{r}
title <- "Baseline POST Plan Bytes"
data <- round(c(mBytesPPCP, mBytesJPCP), 2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Bytes")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)

```

#### Throughput

```{r}
title <- "Baseline POST Plan Throughput"
data <- c(stats$Throughput[4],stats$Throughput[16])
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Throughput /sec ")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)

```

# Load

**Conditions**

Test Setup

\|- Baseline Thread Group\
\|-\|-- GET All Plan\
\|-\|-- GET Plan from User\
\|-\|-- POST Create Subscriber\
\|-\|-- POST Create Plan

Thread Options

| Number of Threads | Ramp-up period (s) | Loop Count | Duration (s) |
|-------------------|--------------------|------------|--------------|
| 600               | 30                 | Infinite   | 360          |

```{r}
library(readr)

## Global Stats

stats <- read_csv("../Stats.csv")

## Load JSON files

jGP <- read_csv("../load/json_get_plan_data.csv")


jGSP <- read_csv("../load/json_get_specific_plan_data.csv")



jPCP <- read_csv("../load/json_post_plan_data.csv")


jPCS <- read_csv("../load/json_post_subs_data.csv")


## Load Protocol Buffers files

pGP <- read_csv("../load/protobuf_get_plan_data.csv")


pGSP <- read_csv("../load/protobuf_get_specific_plan_data.csv")



pPCP <- read_csv("../load/protobuf_post_plan_data.csv")


pPCS <- read_csv("../load/protobuf_post_subs_data.csv")



#### MEAN

## MEAN Elapsed

# JSON

mTimeJGP<-mean(jGP$elapsed)
mTimeJGSP<-mean(jGSP$elapsed)
mTimeJPCP<-mean(jPCP$elapsed)
mTimeJPCS<-mean(jPCS$elapsed)


# Protobuf

mTimePGP<-mean(pGP$elapsed)
mTimePGSP<-mean(pGSP$elapsed)
mTimePPCP<-mean(pPCP$elapsed)
mTimePPCS<-mean(pPCS$elapsed)

## MEAN Bytes

# JSON

mBytesJGP<-mean(jGP$bytes)
mBytesJGSP<-mean(jGSP$bytes)
mBytesJPCP<-mean(jPCP$bytes)
mBytesJPCS<-mean(jPCS$bytes)


# Protobuf

mBytesPGP<-mean(pGP$bytes)
mBytesPGSP<-mean(pGSP$bytes)
mBytesPPCP<-mean(pPCP$bytes)
mBytesPPCS<-mean(pPCS$bytes)

```

## Data

```{r}
library(knitr)

# Sample data
data <- data.frame(
  Endpoint = c("GET Plan","GET Specific Plan", "POST Subscriber", "POST Plan"),
  Mean_Elapsed_Time = c(round(mTimePGP,2),round(mTimePGSP,2),round(mTimePPCS,2),round(mTimePPCP,2)),
  Median_Elapsed_Time = round(c(median(pGP$elapsed),median(pGSP$elapsed),median(pPCS$elapsed),median(pPCP$elapsed)),2),
  #Elapsed_Time_Standart_Deviation = round(c(sd(pGP$elapsed),sd(pGSP$elapsed),sd(pPCS$elapsed),sd(pPCP$elapsed)),2),
  Mean_Bytes = c(round(mBytesPGP,2),round(mBytesPGSP,2),round(mBytesPPCS,2),round(mBytesPPCS,2)),
  Median_Bytes = round(c(median(pGP$bytes),median(pGSP$bytes),median(pPCS$bytes),median(pPCP$bytes)),2),
   #Bytes_Standart_Deviation = round(c(sd(pGP$bytes),sd(pGSP$bytes),sd(pPCS$bytes),sd(pPCP$bytes)),2),
  Throughput = c(stats$Throughput[5],stats$Throughput[6],stats$Throughput[7], stats$Throughput[8]),
  Error = c(stats$Error[5],stats$Error[6],stats$Error[7], stats$Error[8] ),
  Samples = c(nrow(pGP),nrow(pGSP),nrow(pPCS),nrow(pPCP))
)

data2 <- data.frame(
 Endpoint = c("GET Plan","GET Specific Plan", "POST Subscriber", "POST Plan"),
  Mean_Elapsed_Time = round(c(mTimeJGP,mTimeJGSP,mTimeJPCS,mTimeJPCP),2),
  Median_Elapsed_Time = round(c(median(jGP$elapsed),median(jGSP$elapsed),median(jPCS$elapsed),median(jPCP$elapsed)),2),
  #Elapsed_Time_Standart_Deviation = round(c(sd(jGP$elapsed),sd(jGSP$elapsed),sd(jPCS$elapsed),sd(jPCP$elapsed)),2),
  Mean_Bytes= round(c(mBytesJGP,mBytesJGSP,mBytesJPCS,mBytesJPCP),2),
  Median_Bytes = round(c(median(jGP$bytes),median(jGSP$bytes),median(jPCS$bytes),median(jPCP$bytes)),2),
  #Bytes_Standart_Deviation = round(c(sd(jGP$bytes),sd(jGSP$bytes),sd(jPCS$bytes),sd(jPCP$bytes)),2),
  Throughput = c(stats$Throughput[17],stats$Throughput[18],stats$Throughput[19],stats$Throughput[20]),
  Error = c(stats$Error[17],stats$Error[18],stats$Error[19],stats$Error[20]),
  Samples = c(nrow(jGP),nrow(jGSP),nrow(jPCS),nrow(jPCP))
)

# Display the table
kable(data, caption = "Performance Metrics for Protobuf Load Tests")
kable(data2, caption = "Performance Metrics for JSON Load Tests")
```

## Bar Plot

### Endpoint - GET Plan

#### Elapsed Time

```{r}
title <- "Load GET Plan Elapsed Time"
data <- round(c(mTimePGP, mTimeJGP),2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Elapsed Time (ms)")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)

```

#### Bytes

```{r}
data <- round(c(mBytesPGP, mBytesJGP), 2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Bytes")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

#### Throughput

```{r}
title <- "Load GET Plan Throughput"
data <- c(stats$Throughput[5],stats$Throughput[17])
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Throughput /sec ")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

legend("topright", legend = names, fill = bar_colors)

```

### Endpoint - GET Specific Plan

#### Elapsed Time

```{r}
title <- "Load GET Specific Plan Elapsed Time"
data <- round(c(mTimePGSP, mTimeJGSP),2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Elapsed Time (ms)")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

#### Bytes

```{r}
title <- "Load GET Specific Plan Bytes"
data <- round(c(mBytesPGSP, mBytesJGSP), 2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Bytes")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

#### Throughput

```{r}
title <- "Load GET Specific Plan Throughput"
data <- c(stats$Throughput[6],stats$Throughput[18])
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Throughput /sec ")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

#### Error

```{r}
title <- "Load GET Specific Plan Error"
data <- c(stats$Error[6],stats$Error[18])
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Error %")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

### Endpoint - POST Subscriber

#### Elapsed Time

```{r}
title <- "Load POST Subscriber Elapsed Time"
data <- round(c(mTimePPCS, mTimeJPCS),2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Elapsed Time (ms)")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

#### Bytes

```{r}
title <- "Load POST Subscriber Bytes"
data <- round(c(mBytesPPCS, mBytesJPCS), 2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Bytes")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)

```

#### Throughput

```{r}
title <- "Load POST Subscriber Throughput"
data <- c(stats$Throughput[7],stats$Throughput[19])
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Throughput /sec ")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

#### Error

```{r}
title <- "Load POST Subscriber Error"
data <- c(stats$Error[7],stats$Error[19])
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Error %")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

### Endpoint - POST Plan

#### Elapsed Time

```{r}
title <- "Load POST Plan Elapsed Time"
data <- round(c(mTimePPCP, mTimeJPCP),2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Elapsed Time (ms)")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

#### Bytes

```{r}
title <- "Load POST Plan Bytes"
data <- round(c(mBytesPPCP, mBytesJPCP), 2)
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Bytes")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)
```

#### Throughput

```{r}
title <- "Load POST Plan Throughput"
data <- c(stats$Throughput[8],stats$Throughput[20])
names <- c("Protobuf", "JSON")
axis <- c("Data Format","Throughput /sec ")
bar_colors <- c("plum2", "cyan3")
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")
legend("topright", legend = names, fill = bar_colors)

```

# Stress

**Conditions**

Test Setup

\|- Baseline Thread Group\
\|-\|-- GET All Plan\
\|-\|-- GET Plan from User\
\|-\|-- POST Create Subscriber\
\|-\|-- POST Create Plan

Thread Options

| Number of Threads | Ramp-up period (s) | Loop Count | Duration (s) |
|-------------------|--------------------|------------|--------------|
| 3000              | 100                | Infinite   | 600          |

```{r}
library(readr)

## Global Stats

stats <- read_csv("../Stats.csv")

## Stress JSON files

jGP <- read_csv("../stress/json_get_plan_data.csv")
jGSP <- read_csv("../stress/json_get_specific_plan_data.csv")
jPCP <- read_csv("../stress/json_post_plan_data.csv")
jPCS <- read_csv("../stress/json_post_subs_data.csv")

## Stress Protocol Buffers files

pGP <- read_csv("../stress/protobuf_get_plan_data.csv")
pGSP <- read_csv("../stress/protobuf_get_specific_plan_data.csv")
pPCP <- read_csv("../stress/protobuf_post_plan_data.csv")
pPCS <- read_csv("../stress/protobuf_post_subs_data.csv")


#### MEAN

## MEAN Elapsed

# JSON

mTimeJGP<-mean(jGP$elapsed)
mTimeJGSP<-mean(jGSP$elapsed)
mTimeJPCP<-mean(jPCP$elapsed)
mTimeJPCS<-mean(jPCS$elapsed)

# Protobuf

mTimePGP<-mean(pGP$elapsed)
mTimePGSP<-mean(pGSP$elapsed)
mTimePPCP<-mean(pPCP$elapsed)
mTimePPCS<-mean(pPCS$elapsed)

## MEAN Bytes

# JSON

mBytesJGP<-mean(jGP$bytes)
mBytesJGSP<-mean(jGSP$bytes)
mBytesJPCP<-mean(jPCP$bytes)
mBytesJPCS<-mean(jPCS$bytes)


# Protobuf

mBytesPGP<-mean(pGP$bytes)
mBytesPGSP<-mean(pGSP$bytes)
mBytesPPCP<-mean(pPCP$bytes)
mBytesPPCS<-mean(pPCS$bytes)

```

## Data

```{r}
library(knitr)

# Sample data
data <- data.frame(
  Endpoint = c("GET Plan","GET Specific Plan", "POST Subscriber", "POST Plan"),
  Mean_Elapsed_Time = c(round(mTimePGP,2),round(mTimePGSP,2),round(mTimePPCS,2),round(mTimePPCP,2)),
  Median_Elapsed_Time = round(c(median(pGP$elapsed),median(pGSP$elapsed),median(pPCS$elapsed),median(pPCP$elapsed)),2),
  #Elapsed_Time_Standart_Deviation = round(c(sd(pGP$elapsed),sd(pGSP$elapsed),sd(pPCS$elapsed),sd(pPCP$elapsed)),2),
  Mean_Bytes = c(round(mBytesPGP,2),round(mBytesPGSP,2),round(mBytesPPCS,2),round(mBytesPPCS,2)),
  Median_Bytes = round(c(median(pGP$bytes),median(pGSP$bytes),median(pPCS$bytes),median(pPCP$bytes)),2),
   #Bytes_Standart_Deviation = round(c(sd(pGP$bytes),sd(pGSP$bytes),sd(pPCS$bytes),sd(pPCP$bytes)),2),
  Throughput = c(stats$Throughput[9],stats$Throughput[10],stats$Throughput[11], stats$Throughput[12]),
  Error = c(stats$Error[9],stats$Error[10],stats$Error[11], stats$Error[12] ),
  Samples = c(nrow(pGP),nrow(pGSP),nrow(pPCS),nrow(pPCP))
)

data2 <- data.frame(
 Endpoint = c("GET Plan","GET Specific Plan", "POST Subscriber", "POST Plan"),
  Mean_Elapsed_Time = round(c(mTimeJGP,mTimeJGSP,mTimeJPCS,mTimeJPCP),2),
  Median_Elapsed_Time = round(c(median(jGP$elapsed),median(jGSP$elapsed),median(jPCS$elapsed),median(jPCP$elapsed)),2),
  #Elapsed_Time_Standart_Deviation = round(c(sd(jGP$elapsed),sd(jGSP$elapsed),sd(jPCS$elapsed),sd(jPCP$elapsed)),2),
  Mean_Bytes= round(c(mBytesJGP,mBytesJGSP,mBytesJPCS,mBytesJPCP),2),
  Median_Bytes = round(c(median(jGP$bytes),median(jGSP$bytes),median(jPCS$bytes),median(jPCP$bytes)),2),
  #Bytes_Standart_Deviation = round(c(sd(jGP$bytes),sd(jGSP$bytes),sd(jPCS$bytes),sd(jPCP$bytes)),2),
  Throughput = c(stats$Throughput[21],stats$Throughput[22],stats$Throughput[23],stats$Throughput[24]),
  Error = c(stats$Error[21],stats$Error[22],stats$Error[23],stats$Error[24]),
  Samples = c(nrow(jGP),nrow(jGSP),nrow(jPCS),nrow(jPCP))
)

# Display the table
kable(data, caption = "Performance Metrics for Protobuf Stress Tests")
kable(data2, caption = "Performance Metrics for JSON Stress Tests")
```

## Bar Plot

### Endpoint - GET Plan

#### Elapsed Time

```{r}
title <- "Stress GET Plan Elapsed Time"

# Graph Data

data <- round(c(mTimePGP, mTimeJGP),2)

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Elapsed Time (ms)")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))
# Calculate median values
medians <- c(median(pGP$elapsed),median(jGP$elapsed))

for (i in 1:length(medians)) {
  # Add a line for the current median value
  lines(x = c(graph[i] - 0.4, graph[i] + 0.4), y = c(medians[i], medians[i]), col = "black", lwd = 2)
  
  # Add text label for the current median value
  text(x = graph[i], y = medians[i] + 1, labels = medians[i], pos = 3, col = "black")
}
# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)

```

#### Bytes

```{r}
title <- "Stress GET Plan Bytes"

# Graph Data
data <- round(c(mBytesPGP, mBytesJGP), 2)

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Bytes")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)
```

#### Throughput

```{r}
# Graph Title

title <- "Stress GET Plan Throughput"

# Graph Data
data <- c(stats$Throughput[9],stats$Throughput[21])

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Throughput /sec ")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)
```

#### Error

```{r}
# Graph Title

title <- "Stress GET Plan Error"

# Graph Data
data <- c(stats$Error[9],stats$Error[21])

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Error %")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)
```

### Endpoint - GET Specific Plan

#### Elapsed Time

```{r}
# Graph Title

title <- "Stress GET Specific Plan Elapsed Time"

# Graph Data

data <- round(c(mTimePGSP, mTimeJGSP),2)

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Elapsed Time (ms)")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)
```

#### Bytes

```{r}
# Graph Title

title <- "Stress GET Specific Plan Bytes"

# Graph Data
data <- round(c(mBytesPGSP, mBytesJGSP), 2)

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Bytes")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)
```

#### Throughput

```{r}
title <- "Stress GET Specific Plan Throughput"

# Graph Data
data <- c(stats$Throughput[10],stats$Throughput[22])

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Throughput /sec ")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)

```

#### Error

```{r}
title <- "Stress GET Specific Plan Error"

# Graph Data
data <- c(stats$Error[10],stats$Error[22])

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Error %")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)
```

### Endpoint - POST Subscriber

#### Elapsed Time

```{r}
# Graph Title

title <- "Stress POST Subscriber Elapsed Time"

# Graph Data

data <- round(c(mTimePPCS, mTimeJPCS),2)

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Elapsed Time (ms)")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)

```

#### Bytes

```{r}
title <- "Stress POST Subscriber Bytes"

# Graph Data
data <- round(c(mBytesPPCS, mBytesJPCS), 2)

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Bytes")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)
```

#### Throughput

```{r}
title <- "Stress POST Subscriber Throughput"

# Graph Data
data <- c(stats$Throughput[11],stats$Throughput[23])

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Throughput /sec ")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)
```

#### Error

```{r}
title <- "Stress POST Subscriber Error"

# Graph Data
data <- c(stats$Error[11],stats$Error[23])

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Error %")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)

```

### Endpoint - POST Plan

#### Elapsed Time

```{r}
title <- "Stress POST Plan Elapsed Time"

# Graph Data

data <- round(c(mTimePPCP, mTimeJPCP),2)

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Elapsed Time (ms)")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)

```

#### Bytes

```{r}
title <- "Stress POST Plan Bytes"

# Graph Data
data <- round(c(mBytesPPCP, mBytesJPCP), 2)

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Bytes")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)
```

#### Throughput

```{r}
title <- "Stress POST Plan Throughput"

# Graph Data
data <- c(stats$Throughput[12],stats$Throughput[24])

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Throughput /sec ")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data + 1, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)
```

#### Error

```{r}
title <- "Stress POST Plan Error"

# Graph Data
data <- c(stats$Error[12],stats$Error[24])

# Bar Names Labels
names <- c("Protobuf", "JSON")

# Bar Axis Names

axis <- c("Data Format","Error %")

# Custom colors for the bars
bar_colors <- c("plum2", "cyan3")

# Create Bar
graph <- barplot(data, names.arg = names, xlab = axis[1], ylab = axis[2], col = bar_colors, main = title ,ylim = c(0, max(data) + max(data)/3))

# Add Value For Each Bar
text(x = graph, y = data, labels = data, pos = 3, col = "black")

# Graph Color Legend
legend("topright", legend = names, fill = bar_colors)

```
